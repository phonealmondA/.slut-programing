<!DOCTYPE html>
<html>
<head>
    <title>GlobeCode - Interactive Python Spherical Editor</title>
    <style>
        body { 
            margin: 0; 
            background: #1e1e1e; 
            font-family: 'Courier New', monospace; 
            overflow: hidden; 
            color: white;
        }
        #container { width: 100vw; height: 100vh; position: relative; }
        #ui-panel { 
            position: absolute; 
            top: 10px; 
            left: 10px; 
            z-index: 100; 
            background: rgba(0,0,0,0.85); 
            padding: 20px; 
            border-radius: 10px;
            border: 2px solid #4a90e2;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }
        #editor-input { 
            position: absolute; 
            bottom: 10px; 
            left: 10px; 
            right: 10px;
            background: rgba(30,30,30,0.95); 
            border: 2px solid #4a90e2; 
            color: #ffffff;
            padding: 20px; 
            font-size: 16px; 
            font-family: 'Courier New', monospace;
            z-index: 100;
            height: 160px;
            resize: vertical;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }
        #file-info {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 100;
            background: rgba(0,0,0,0.85);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
        }
        #help-panel {
            position: absolute;
            bottom: 200px;
            right: 10px;
            z-index: 100;
            background: rgba(0,0,0,0.85);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
            font-size: 12px;
            max-width: 280px;
        }
        .control-button {
            background: linear-gradient(45deg, #4a90e2, #357abd);
            border: none;
            color: white;
            padding: 12px 18px;
            margin: 4px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(74, 144, 226, 0.3);
        }
        .control-button:hover {
            background: linear-gradient(45deg, #357abd, #285a8e);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.5);
        }
        .control-button:active {
            transform: translateY(0);
        }
        #editor-input::placeholder {
            color: #aaa;
        }
        h3 {
            margin-top: 0;
            color: #4a90e2;
            text-shadow: 0 2px 4px rgba(74, 144, 226, 0.5);
        }
        .status-text {
            color: #00ff00;
            text-shadow: 0 1px 2px rgba(0, 255, 0, 0.5);
        }
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            color: #4a90e2;
            font-size: 18px;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #4a90e2;
        }
        .help-text {
            color: #ccc;
            line-height: 1.4;
        }
        .color-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        .color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        .legend-item {
            font-size: 10px;
            display: flex;
            align-items: center;
            margin-bottom: 3px;
        }
        .data-flow-legend {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #444;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <div id="loading">üêç Loading Python interpreter... Please wait</div>
    
    <div id="ui-panel">
        <h3>üêç GlobeCode Interactive Editor</h3>
        <p>Lines: <span id="line-count" class="status-text">0</span> | Chars: <span id="char-count" class="status-text">0</span></p>
        <button class="control-button" onclick="toggleSyntaxHighlight()">üé® Syntax</button>
        <button class="control-button" onclick="rotateSphere()">üîÑ Rotate</button>
        <button class="control-button" onclick="runCode()">‚ñ∂ Execute</button>
        <button class="control-button" onclick="resetView()">üè† Reset</button>
    </div>
    
    <div id="file-info">
        <strong>File:</strong> script.py<br>
        <strong>Language:</strong> <span class="status-text">Python</span><br>
        <strong>Active Nodes:</strong> <span id="active-nodes" class="status-text">0</span>
    </div>

    <div id="help-panel">
        <h4 style="margin-top: 0; color: #4a90e2; font-size: 14px;">üéÆ Enhanced Controls</h4>
        <div class="help-text">
            <strong>Left Click:</strong> Expand/collapse code view<br>
            <strong>Right Click:</strong> Enable/disable node<br>
            <strong>Drag:</strong> Move node around sphere<br>
            <strong>Mouse Wheel:</strong> Zoom in/out<br><br>
            <strong>Node Colors:</strong>
        </div>
        <div class="color-legend">
            <div class="legend-item">
                <div class="color-dot" style="background-color: #ffc107;"></div>
                Functions
            </div>
            <div class="legend-item">
                <div class="color-dot" style="background-color: #f44336;"></div>
                Loops
            </div>
            <div class="legend-item">
                <div class="color-dot" style="background-color: #9c27b0;"></div>
                Conditions
            </div>
            <div class="legend-item">
                <div class="color-dot" style="background-color: #2196f3;"></div>
                Classes
            </div>
            <div class="legend-item">
                <div class="color-dot" style="background-color: #9e9e9e;"></div>
                Single Lines
            </div>
        </div>
        <div class="data-flow-legend">
            <div class="help-text">
                <strong>üîó Data Flow:</strong><br>
                <span style="color: #ffaa00;">‚óè</span> Orange lines: Variable/function flow<br>
                <span style="color: #ff6b6b;">‚óè</span> Red dots: Loop nodes (nested)<br>
                <span style="color: #4ecdc4;">‚óè</span> Teal dots: Condition nodes (nested)<br>
                <span style="color: #00ff00;">‚óè</span> Output rings: Print results<br>
            </div>
        </div>
    </div>

    <textarea id="editor-input" placeholder="Write your Python code here! Enhanced with ring-based output visualization.

# Try this advanced example:
def change(a):
    b = []
    for i in a:
        print(f'Processing: {i}')
        b.append(i)
    return b

A = {'katie': 1, 'noah': 2}
B = change(A)
print(B)

# Watch the output rings:
# - Each node with prints gets its own colored ring
# - Ring size adapts to number of outputs
# - Outputs are evenly distributed around the ring
# - Rings move with their nodes when dragged"></textarea>
    
    <!-- Three.js for 3D visualization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Skulpt for Python execution -->
    <script src="https://unpkg.com/skulpt@0.11.1/dist/skulpt.min.js"></script>
    <script src="https://unpkg.com/skulpt@0.11.1/dist/skulpt-stdlib.js"></script>
    
    <!-- Our enhanced interactive editor -->
    <script src="globe-editor-v2.js"></script>

    <script>
        // Update active node count
        function updateActiveNodeCount() {
            const activeCount = codeNodes.filter(node => node.isActive).length;
            document.getElementById('active-nodes').textContent = activeCount;
        }
        
        // Override some functions to update the count
        const originalToggleNodeActive = toggleNodeActive;
        toggleNodeActive = function(node) {
            originalToggleNodeActive(node);
            updateActiveNodeCount();
        };
        
        const originalCreateNodesOnSphere = createNodesOnSphere;
        createNodesOnSphere = function(blocks, radius) {
            originalCreateNodesOnSphere(blocks, radius);
            updateActiveNodeCount();
        };
    </script>
</body>
</html>
